<p-growl styleClass="message-growl" [baseZIndex]="1050" [(value)]="msgs"></p-growl>

<app-aqis-update-assistant-reports #updateAssistantReports (reload)="reloadPage()"></app-aqis-update-assistant-reports>

<section class="assistant-report-filters">
  <app-aqis-progress-assistant-filters [loading]="loading"
                                       [submitted]="submitted"
                                       (sendRequest)="submitFilters($event)"
  ></app-aqis-progress-assistant-filters>
</section>

<section *ngIf="reports">
  <ol class="list-group">
    <li class="list-group-item">
      <div class="ui-g">
        <div class="ui-g-12">
          <button class="btn btn-info float-right" (click)="showDialog()">Update Report</button>
        </div>
      </div>
    </li>
    <li *ngIf="loading" class="list-group-item">
      <p-progressBar *ngIf="loading" mode="indeterminate" [style]="{'height': '6px'}"></p-progressBar>
    </li>
    <li *ngFor="let report of reports" class="list-group-item">
      <section>
        <table class="table table-info table-bordered">
          <tr>
            <th class="text-center" rowspan="3">{{report.assistant}}</th>
            <th class="text-center" rowspan="2">Projects</th>
            <th class="text-center" colspan="4">Companies</th>
            <th class="text-center" colspan="2">Working Time</th>
            <th class="text-center" colspan="2">Steps</th>
          </tr>
          <tr>
            <th class="text-center">Total</th>
            <th class="text-center">In Progress</th>
            <th class="text-center">Closed</th>
            <th class="text-center">Succeed</th>
            <th class="text-center">Performed</th>
            <th class="text-center">Total</th>
            <th class="text-center">Performed</th>
            <th class="text-center">Total</th>
          </tr>
          <tr>
            <td class="text-right">{{report.projects.length}}</td>
            <td class="text-right">{{report.total_companies}}</td>
            <td class="text-right">{{report.companies_in_progress}}</td>
            <td class="text-right">{{report.companies_closed}}</td>
            <td class="text-right">{{report.companies_succeed}}</td>
            <td class="text-right">{{report.time_performed * 24 | number:'1.0-0'}}</td>
            <td class="text-right">{{report.time_total * 24 | number:'1.0-0'}}</td>
            <td class="text-right">{{report.steps_performed}}</td>
            <td class="text-right">{{report.steps_total}}</td>
          </tr>
        </table>
      </section>
      <p-accordion>
        <p-accordionTab *ngFor="let project of report.projects" [header]="project.name">
          <app-aqis-progress-project-table [project]="project"></app-aqis-progress-project-table>
        </p-accordionTab>
      </p-accordion>
    </li>
  </ol>
</section>
